<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GLITCHWORKS.AI // Systems Architecture Holding</title>
    <meta name="description" content="GlitchWorks - Systems Architecture Holding Company. Asset Light. Profit First. Riga-Warsaw Joint Ventures.">
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" 
            integrity="sha256-+GldI2d/aE/6p+HeyJp0tezcxKe8TqZNAq5JzgZVfSs=" 
            crossorigin="anonymous"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" 
            integrity="sha256-+Gldvt/dh2p6uxwvFNc4R/ysVQvHr2aP6V+H9j/0w4=" 
            crossorigin="anonymous"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js" 
            crossorigin="anonymous"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --color-cyan-primary: #22d3ee;
            --color-pink-primary: #ec4899;
            --color-green-primary: #10b981;
            --boot-delay-base: 300;
            --matrix-fps: 30;
        }
        
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        
        .glitch-text {
            text-shadow: 2px 0 var(--color-cyan-primary), -2px 0 var(--color-pink-primary);
            animation: glitch 3s infinite linear alternate-reverse;
        }
        
        @keyframes glitch {
            0% { text-shadow: 2px 0 var(--color-cyan-primary), -2px 0 var(--color-pink-primary); transform: skew(0deg); }
            5% { text-shadow: 2px 0 var(--color-cyan-primary), -2px 0 var(--color-pink-primary); transform: skew(0deg); }
            10% { text-shadow: -2px 0 #f00, 2px 0 #0f0; transform: skew(10deg); }
            15% { text-shadow: 2px 0 var(--color-cyan-primary), -2px 0 var(--color-pink-primary); transform: skew(0deg); }
            100% { text-shadow: 2px 0 var(--color-cyan-primary), -2px 0 var(--color-pink-primary); transform: skew(0deg); }
        }
        
        @keyframes flicker {
            0% { opacity: 0.02; }
            5% { opacity: 0.05; }
            10% { opacity: 0.02; }
            100% { opacity: 0.02; }
        }
        
        .animate-flicker { animation: flicker 4s infinite; }
        
        @media (prefers-reduced-motion: reduce) {
            .glitch-text { animation: none; text-shadow: none; }
            .animate-pulse { animation: none !important; }
            .scanlines { display: none !important; }
        }
        
        *:focus-visible {
            outline: 2px solid var(--color-cyan-primary);
            outline-offset: 2px;
        }
        
        .crt-glow {
            text-shadow: 0 0 10px rgba(34, 211, 238, 0.5);
        }
        
        .skip-link {
            position: absolute;
            top: -100px;
            left: 0;
            background: #000;
            color: var(--color-cyan-primary);
            padding: 0.5rem 1rem;
            z-index: 100;
            border: 2px solid var(--color-cyan-primary);
        }
        
        .skip-link:focus {
            top: 0.5rem;
            left: 0.5rem;
        }
    </style>
</head>
<body>
    <a href="#terminal-input" class="skip-link">Skip to terminal</a>
    <div id="root"></div>

    <noscript>
        <div style="padding: 2rem; text-align: center; background: #000; color: #22d3ee; font-family: monospace; min-height: 100vh;">
            <h1 style="font-size: 2rem; margin-bottom: 1rem;">GLITCHWORKS.AI</h1>
            <p style="margin-bottom: 0.5rem;">Systems Architecture Holding Company</p>
            <p style="margin-bottom: 1rem;">Riga ‚Üí Warsaw // Joint Ventures // Digital Infrastructure</p>
            <p style="margin-bottom: 0.5rem;"><strong>Contact:</strong> connect@glitchworks.ai</p>
            <p style="margin-top: 2rem; font-size: 0.875rem; opacity: 0.7;">Enable JavaScript for full experience</p>
        </div>
    </noscript>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Constants
        const BOOT_DELAY_MS = 300;
        const MATRIX_FPS = 30;
        const MATRIX_FONT_SIZE = 14;
        const COMMAND_BUFFER_SIZE = 4;
        const KONAMI_BUFFER_SIZE = 10;

        // Icons (inline SVG to avoid external deps)
        const Terminal = () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>;
        const Globe = () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>;
        const Shield = () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>;
        const Cpu = () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect><rect x="9" y="9" width="6" height="6"></rect><line x1="9" y1="1" x2="9" y2="4"></line><line x1="15" y1="1" x2="15" y2="4"></line><line x1="9" y1="20" x2="9" y2="23"></line><line x1="15" y1="20" x2="15" y2="23"></line><line x1="20" y1="9" x2="23" y2="9"></line><line x1="20" y1="14" x2="23" y2="14"></line><line x1="1" y1="9" x2="4" y2="9"></line><line x1="1" y1="14" x2="4" y2="14"></line></svg>;
        const Anchor = () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="5" r="3"></circle><line x1="12" y1="22" x2="12" y2="8"></line><path d="M5 12H2a10 10 0 0 0 20 0h-3"></path></svg>;
        const Lock = () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>;
        const Radio = () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="2"></circle><path d="M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14"></path></svg>;
        const AlertTriangle = () => <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>;

        const BOOT_SEQUENCE = [
            { text: "> POWER_ON_SELF_TEST... [PASS]", delay: 200 },
            { text: "> CHECKING_MEMORY... 64GB OK", delay: 400 },
            { text: "> INITIALIZING GLITCHWORKS KERNEL v2.4.0...", delay: 800 },
            { text: "> MOUNTING VOLUME: /dev/sdb1 (ASSET_LIGHT_DOCTRINE)... [OK]", delay: 1200 },
            { text: "> RESOLVING DOMAIN: GLITCHWORKS.ONLINE... [VERIFIED]", delay: 1500 },
            { text: "> ESTABLISHING SECURE TUNNEL (RIGA <-> GLOBAL)...", delay: 1900 },
            { text: "> PING RIGA_NODE (LAT)... 14ms", delay: 2100 },
            { text: "> PING MOBILE_NODE (UNKNOWN)... 45ms", delay: 2300 },
            { text: "> LOADING MODULES: [ REACT, TAILWIND, SPITE_ENGINE ]", delay: 2700 },
            { text: "> SYSTEM READY. WELCOME, OPERATOR.", delay: 3200, style: "text-green-400 font-bold" },
        ];

        const COMMANDS = [
            { cmd: "help", desc: "List available system commands" },
            { cmd: "status", desc: "Display system telemetry" },
            { cmd: "whoami", desc: "Identify current user session" },
            { cmd: "manifesto", desc: "Display core directive" },
            { cmd: "services", desc: "List service offerings" },
            { cmd: "stack", desc: "Display tech arsenal" },
            { cmd: "contact", desc: "Open communication channels" },
            { cmd: "clear", desc: "Purge terminal history" },
            { cmd: "matrix", desc: "Matrix rain effect" },
        ];

        // Error Boundary Component
        class ErrorBoundary extends React.Component {
            constructor(props) {
                super(props);
                this.state = { hasError: false, error: null };
            }

            static getDerivedStateFromError(error) {
                return { hasError: true, error };
            }

            componentDidCatch(error, errorInfo) {
                console.error('GLITCHWORKS ERROR:', error, errorInfo);
            }

            render() {
                if (this.state.hasError) {
                    return (
                        <div className="min-h-screen bg-black text-red-500 p-10 font-mono">
                            <div className="max-w-4xl mx-auto border border-red-900 p-6 rounded-lg">
                                <h1 className="text-3xl font-bold mb-4">‚ö†Ô∏è KERNEL PANIC</h1>
                                <p className="mb-4">Critical system error detected. Please refresh to reboot.</p>
                                <pre className="text-xs text-red-300 overflow-auto">
                                    {this.state.error?.toString()}
                                </pre>
                                <button
                                    onClick={() => window.location.reload()}
                                    className="mt-4 px-4 py-2 border border-red-700 hover:bg-red-900/20 transition-colors rounded"
                                >
                                    [REBOOT SYSTEM]
                                </button>
                            </div>
                        </div>
                    );
                }

                return this.props.children;
            }
        }

        function App() {
            const [lines, setLines] = useState([]);
            const [bootIndex, setBootIndex] = useState(0);
            const [isBooting, setIsBooting] = useState(true);
            const [input, setInput] = useState("");
            const [history, setHistory] = useState([]);
            const [effectsEnabled, setEffectsEnabled] = useState(true);
            const [glitchMode, setGlitchMode] = useState(false);
            const [time, setTime] = useState(new Date());
            const [ariaLive, setAriaLive] = useState('off');
            const [tabMatchIndex, setTabMatchIndex] = useState(0);
            const bottomRef = useRef(null);
            const inputRef = useRef(null);
            const keyBuffer = useRef([]);
            const konamiBuffer = useRef([]);
            const [commandHistory, setCommandHistory] = useState([]);
            const [historyIndex, setHistoryIndex] = useState(-1);

            const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

            // Clock tick
            useEffect(() => {
                const timer = setInterval(() => setTime(new Date()), 1000);
                return () => clearInterval(timer);
            }, []);

            // Easter egg listener (global - works even when input not focused)
            useEffect(() => {
                const handleGlobalKeyDown = (e) => {
                    keyBuffer.current = [...keyBuffer.current, e.key.toLowerCase()].slice(-COMMAND_BUFFER_SIZE);
                    if (keyBuffer.current.join('') === 'lmao') {
                        setGlitchMode(prev => {
                            const newMode = !prev;
                            console.log('Easter egg: GLITCH MODE', newMode ? 'ENABLED' : 'DISABLED');
                            return newMode;
                        });
                        setHistory(prev => [...prev, { 
                            type: 'output', 
                            text: ">> SECRET CODE DETECTED: GLITCH MODE " + (!glitchMode ? "ENABLED" : "DISABLED") + " <<", 
                            style: "text-pink-500 font-bold glitch-text" 
                        }]);
                    }
                    
                    const konamiCode = ['arrowup', 'arrowup', 'arrowdown', 'arrowdown', 'arrowleft', 'arrowright', 'arrowleft', 'arrowright', 'b', 'a'];
                    konamiBuffer.current = [...konamiBuffer.current, e.key.toLowerCase()].slice(-KONAMI_BUFFER_SIZE);
                    if (konamiBuffer.current.join(',') === konamiCode.join(',')) {
                        console.log('Easter egg: KONAMI CODE activated');
                        setHistory(prev => [...prev, { 
                            type: 'output', 
                            text: "üéÆ KONAMI CODE ACTIVATED! üéÆ\n>> 30 LIVES GRANTED\n>> INFINITE SPITE UNLOCKED\n>> DEVELOPER MODE: ENABLED", 
                            style: "text-yellow-400 font-bold animate-pulse" 
                        }]);
                        konamiBuffer.current = [];
                    }
                };
                window.addEventListener('keydown', handleGlobalKeyDown);
                return () => window.removeEventListener('keydown', handleGlobalKeyDown);
            }, [glitchMode]);

            // Boot sequence with accessibility
            useEffect(() => {
                if (prefersReducedMotion) {
                    setLines(BOOT_SEQUENCE);
                    setIsBooting(false);
                    setAriaLive('polite');
                    setHistory([
                        { type: 'output', text: 'System ready. Terminal active.', style: 'sr-only' },
                        { type: 'component', component: <ManifestoBlock /> }
                    ]);
                    return;
                }

                if (bootIndex < BOOT_SEQUENCE.length) {
                    const timeout = setTimeout(() => {
                        setLines(prev => [...prev, BOOT_SEQUENCE[bootIndex]]);
                        setBootIndex(prev => prev + 1);
                    }, BOOT_DELAY_MS);
                    return () => clearTimeout(timeout);
                } else if (bootIndex === BOOT_SEQUENCE.length) {
                    setIsBooting(false);
                    setAriaLive('polite');
                    setTimeout(() => {
                        setHistory([
                            { type: 'output', text: 'System ready. Terminal active.', style: 'sr-only' },
                            { type: 'component', component: <ManifestoBlock /> }
                        ]);
                    }, 500);
                }
            }, [bootIndex, prefersReducedMotion]);

            useEffect(() => {
                bottomRef.current?.scrollIntoView({ behavior: "smooth" });
            }, [lines, history]);

            useEffect(() => {
                if (!isBooting && inputRef.current) {
                    inputRef.current.focus();
                    // Mobile keyboard occlusion fix
                    if (window.innerWidth < 768) {
                        inputRef.current.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
            }, [isBooting]);

            const executeCommand = (cmd) => {
                console.log('Command executed:', cmd);
                const newHistory = [...history, { type: 'input', text: `> ${cmd}` }];
                let response = { type: 'output', text: `Command not found: ${cmd}. Type 'help' for options.` };

                if (cmd && !commandHistory.includes(cmd)) {
                    setCommandHistory(prev => [...prev, cmd]);
                }

                if (cmd === 'help') {
                    response = { type: 'component', component: <HelpBlock /> };
                } else if (cmd === 'clear') {
                    setHistory([]);
                    setLines([]);
                    return;
                } else if (cmd === 'whoami') {
                    response = { type: 'output', text: "USER: " + (glitchMode ? "OPERATOR [VERIFIED]" : "GUEST [UNREGISTERED]") + "\nROLE: " + (glitchMode ? "ARCHITECT" : "OBSERVER") + "\nACCESS: " + (glitchMode ? "READ_WRITE" : "READ_ONLY") };
                } else if (cmd === 'status') {
                    response = { type: 'component', component: <StatusBlock glitchMode={glitchMode} /> };
                } else if (cmd === 'contact') {
                    response = { type: 'output', text: "SIGNAL FREQUENCY OPEN: connect@glitchworks.online", style: "text-yellow-400" };
                } else if (cmd === 'manifesto') {
                    response = { type: 'component', component: <ManifestoBlock /> };
                } else if (cmd === 'services') {
                    response = { type: 'component', component: <ServicesBlock /> };
                } else if (cmd === 'stack') {
                    response = { type: 'component', component: <StackBlock /> };
                } else if (cmd === 'sudo') {
                    response = { type: 'output', text: "nice try, kid.", style: "text-red-500 font-bold" };
                } else if (cmd === 'matrix') {
                    response = { type: 'component', component: <MatrixCanvas /> };
                }

                setHistory([...newHistory, response]);
            };

            const handleCommand = (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const cmd = input.trim().toLowerCase();
                    if (!cmd) return;
                    executeCommand(cmd);
                    setInput("");
                    setHistoryIndex(-1);
                    setTabMatchIndex(0);
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    if (commandHistory.length === 0) return;
                    const newIndex = historyIndex === -1 ? commandHistory.length - 1 : Math.max(0, historyIndex - 1);
                    setHistoryIndex(newIndex);
                    setInput(commandHistory[newIndex]);
                } else if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    if (historyIndex === -1) return;
                    const newIndex = Math.min(commandHistory.length - 1, historyIndex + 1);
                    setHistoryIndex(newIndex);
                    setInput(commandHistory[newIndex]);
                } else if (e.key === 'Tab') {
                    e.preventDefault();
                    const currentInput = input.toLowerCase();
                    if (!currentInput) return;
                    
                    const matches = COMMANDS.filter(c => c.cmd.startsWith(currentInput));
                    if (matches.length === 1) {
                        setInput(matches[0].cmd);
                        setTabMatchIndex(0);
                    } else if (matches.length > 1) {
                        // Cycle through matches on repeated Tab
                        const nextIndex = (tabMatchIndex + 1) % matches.length;
                        setInput(matches[nextIndex].cmd);
                        setTabMatchIndex(nextIndex);
                    }
                } else if (e.key === 'Escape') {
                    // Focus trap release
                    e.preventDefault();
                    if (document.activeElement === inputRef.current) {
                        inputRef.current.blur();
                        setHistory(prev => [...prev, {
                            type: 'output',
                            text: '>> FOCUS RELEASED. Press Tab to return to terminal.',
                            style: 'text-cyan-600 text-xs'
                        }]);
                    }
                } else {
                    // Reset tab match index on other keys
                    setTabMatchIndex(0);
                }
            };

            const skipBoot = () => {
                console.log('Boot sequence skipped');
                setLines(BOOT_SEQUENCE);
                setBootIndex(BOOT_SEQUENCE.length);
                setIsBooting(false);
                setAriaLive('polite');
                setHistory([
                    { type: 'output', text: 'System ready. Terminal active.', style: 'sr-only' },
                    { type: 'component', component: <ManifestoBlock /> }
                ]);
            };

            return (
                <div className={`min-h-screen font-mono p-4 md:p-10 relative overflow-hidden selection:bg-cyan-900 selection:text-white transition-colors duration-500 ${glitchMode ? 'bg-[#0a0005] text-pink-300' : 'bg-black text-cyan-400'}`}>
                    {/* CRT EFFECTS (respect user preferences) */}
                    {effectsEnabled && !prefersReducedMotion && (
                        <>
                            <div className="scanlines pointer-events-none fixed inset-0 z-50 bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.25)_50%),linear-gradient(90deg,rgba(255,0,0,0.06),rgba(0,255,0,0.02),rgba(0,0,255,0.06))] bg-[length:100%_4px,6px_100%] bg-repeat mix-blend-color-dodge opacity-20"></div>
                            <div className="pointer-events-none fixed inset-0 z-50 shadow-[inset_0_0_100px_rgba(0,0,0,0.9)]"></div>
                            <div className="pointer-events-none fixed inset-0 z-40 bg-white opacity-[0.02] animate-flicker"></div>
                        </>
                    )}

                    <main className={`max-w-4xl mx-auto border p-6 rounded-lg bg-black/90 relative z-10 min-h-[80vh] flex flex-col shadow-[0_0_20px_rgba(0,0,0,0.5)] ${glitchMode ? 'border-pink-900/50 shadow-pink-500/20' : 'border-cyan-900/50 shadow-cyan-500/10'}`}>
                        
                        {/* HEADER */}
                        <header className={`flex justify-between items-end border-b pb-4 mb-4 ${glitchMode ? 'border-pink-900/50' : 'border-cyan-900/50'}`}>
                            <div>
                                <h1 className={`text-3xl md:text-5xl font-bold tracking-tighter text-white ${effectsEnabled && !prefersReducedMotion ? 'glitch-text' : 'crt-glow'}`}>
                                    GLITCHWORKS<span className={glitchMode ? 'text-pink-400' : 'text-cyan-400'}>.ONLINE</span>
                                </h1>
                                <p className={`text-xs mt-1 ${glitchMode ? 'text-pink-700' : 'text-cyan-700'}`}>SYSTEMS ARCHITECTURE // HOLDING</p>
                            </div>
                            <div className="text-right hidden md:block">
                                <div className="flex items-center justify-end gap-2 text-xs font-bold text-white mb-1">
                                    {time.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false })}
                                </div>
                                <div className="flex items-center gap-2 text-xs text-green-500">
                                    <span className="relative flex h-2 w-2">
                                        <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                                        <span className="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span>
                                    </span>
                                    <span role="status" aria-live="polite">SYSTEM ACTIVE</span>
                                </div>
                                <p className={`text-xs ${glitchMode ? 'text-pink-900' : 'text-cyan-900'}`}>UPTIME: {Math.floor(time.getTime() / 1000) % 10000}s</p>
                            </div>
                        </header>

                        {/* SKIP BOOT BUTTON */}
                        {isBooting && (
                            <button 
                                onClick={skipBoot}
                                className="absolute top-4 right-4 text-xs text-cyan-500 hover:text-white transition-colors px-2 py-1 border border-cyan-700 hover:bg-cyan-900/20 rounded"
                                aria-label="Skip boot sequence"
                            >
                                [SKIP &gt;&gt;]
                            </button>
                        )}

                        {/* TERMINAL OUTPUT */}
                        <section 
                            className="flex-grow space-y-1 overflow-y-auto mb-4 scrollbar-hide font-medium text-sm md:text-base leading-relaxed"
                            role="log"
                            aria-live={ariaLive}
                            aria-atomic="false"
                            aria-label="Terminal output"
                        >
                            {lines.map((line, i) => (
                                <div key={i} className={`${line.style || (glitchMode ? "text-pink-400/80" : "text-cyan-400/80")} break-words`}>
                                    {line.text}
                                </div>
                            ))}
                            
                            {history.map((entry, i) => (
                                <div key={`hist-${i}`} className="mt-2">
                                    {entry.type === 'input' ? (
                                        <div className="text-white/90 flex gap-2">
                                            <span className={glitchMode ? 'text-pink-600' : 'text-green-600'}>‚ûú</span>
                                            {entry.text}
                                        </div>
                                    ) : entry.type === 'component' ? (
                                        <div className={glitchMode ? 'text-pink-300' : 'text-cyan-300'}>{entry.component}</div>
                                    ) : (
                                        <div className={`${entry.style || (glitchMode ? "text-pink-400/80" : "text-cyan-400/80")} ml-4 whitespace-pre-wrap`}>{entry.text}</div>
                                    )}
                                </div>
                            ))}
                            
                            <div ref={bottomRef} />
                        </section>

                        {/* MOBILE COMMAND BUTTONS */}
                        {!isBooting && (
                            <div className="flex flex-wrap gap-2 mb-4 md:hidden">
                                {COMMANDS.map(c => (
                                    <button
                                        key={c.cmd}
                                        onClick={() => executeCommand(c.cmd)}
                                        className="px-3 py-1 text-sm border border-cyan-700 hover:bg-cyan-900/20 transition-colors rounded"
                                    >
                                        {c.cmd}
                                    </button>
                                ))}
                            </div>
                        )}

                        {/* TERMINAL INPUT */}
                        {!isBooting && (
                            <form 
                                onSubmit={(e) => { e.preventDefault(); handleCommand({ key: 'Enter', preventDefault: () => {} }); }}
                                className={`border-t pt-4 ${glitchMode ? 'border-pink-900/30' : 'border-cyan-900/30'}`}
                            >
                                <label htmlFor="terminal-input" className="sr-only">
                                    Terminal command input. Press Escape to release focus, Tab for autocomplete.
                                </label>
                                <div className="flex items-center gap-2">
                                    <span className={`font-bold ${glitchMode ? 'text-pink-500' : 'text-green-500'}`}>root@glitchworks:~#</span>
                                    <input
                                        ref={inputRef}
                                        id="terminal-input"
                                        type="text"
                                        value={input}
                                        onChange={(e) => setInput(e.target.value)}
                                        onKeyDown={handleCommand}
                                        onFocus={() => {
                                            if (window.innerWidth < 768) {
                                                setTimeout(() => {
                                                    inputRef.current?.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                                }, 300);
                                            }
                                        }}
                                        className={`bg-transparent border-none outline-none w-full font-bold ${glitchMode ? 'text-pink-100 caret-pink-500' : 'text-cyan-100 caret-cyan-500'}`}
                                        placeholder="Awaiting command..."
                                        aria-describedby="command-hint"
                                    />
                                </div>
                                <span id="command-hint" className="sr-only">
                                    Type help for available commands. Press Tab for autocomplete. Press Escape to release focus.
                                </span>
                            </form>
                        )}

                        {/* FX TOGGLE */}
                        {!prefersReducedMotion && (
                            <button
                                onClick={() => setEffectsEnabled(!effectsEnabled)}
                                className="absolute bottom-4 left-4 text-[10px] text-cyan-800 hover:text-cyan-500 transition-colors"
                                aria-label={effectsEnabled ? "Disable visual effects" : "Enable visual effects"}
                            >
                                [FX: {effectsEnabled ? 'ON' : 'OFF'}]
                            </button>
                        )}
                    </main>

                    {/* FOOTER */}
                    <footer className="absolute bottom-4 left-0 w-full text-center text-[10px] opacity-40 z-10">
                        <p>COPYRIGHT ¬© 2026 GLITCHWORKS MAZKAPITƒÄLA SIA // RIGA - WORLDWIDE</p>
                    </footer>
                </div>
            );
        }

        // --- SUB-COMPONENTS ---

        const HelpBlock = () => (
            <div className="ml-2 text-sm border-l-2 border-cyan-800 pl-4 my-2 space-y-3">
                <div className="text-cyan-500/60 text-xs uppercase tracking-wider mb-4">Available Commands</div>
                <div className="space-y-2">
                    {COMMANDS.map((c, i) => (
                        <div key={i} className="flex flex-col md:flex-row md:items-baseline gap-1 md:gap-3">
                            <span className="text-white font-bold min-w-[120px]">{c.cmd}</span>
                            <span className="text-cyan-300/70 text-xs md:text-sm">{c.desc}</span>
                        </div>
                    ))}
                </div>
                <div className="mt-4 pt-3 border-t border-cyan-900/30 text-xs text-cyan-700">
                    Tips: Tab completion ‚Ä¢ Arrow keys for history ‚Ä¢ Escape to release focus
                </div>
            </div>
        );

        const StatusBlock = ({ glitchMode }) => (
            <div className="ml-2 p-4 bg-white/5 border border-white/10 rounded text-sm space-y-2 backdrop-blur-sm">
                <div className="flex items-center gap-2">
                    <Globe /> NODE_01: <span className="text-white font-bold">RIGA [ACTIVE]</span>
                </div>
                <div className="flex items-center gap-2">
                    <Radio /> NODE_02: <span className="text-white font-bold">MOBILE [ACQUIRING TARGET]</span>
                </div>
                <div className="flex items-center gap-2">
                    <Cpu /> CPU_LOAD: <span className="text-white font-bold">NOMINAL</span>
                </div>
                <div className="flex items-center gap-2">
                    <Lock /> ASSET_LIGHT: <span className="text-green-400 font-bold">TRUE</span>
                </div>
                <div className="flex items-center gap-2">
                    <span className="text-xs opacity-60">üëÅÔ∏è</span> MODE: <span className={`font-bold ${glitchMode ? 'text-pink-500' : 'text-cyan-500'}`}>{glitchMode ? 'GLITCH [ENABLED]' : 'STANDARD [ACTIVE]'}</span>
                </div>
                <div className="flex items-center gap-2">
                    <Shield /> SLANDER_BLOCK: <span className="text-green-400 font-bold">ACTIVE (100%)</span>
                </div>
            </div>
        );

        const MatrixCanvas = () => {
            const canvasRef = useRef(null);
            const [isRunning, setIsRunning] = useState(true);
            
            useEffect(() => {
                const canvas = canvasRef.current;
                if (!canvas) return;
                
                const ctx = canvas.getContext('2d');
                canvas.width = canvas.offsetWidth;
                canvas.height = 400;
                
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%^&*()_+-=[]{}|;:,.<>?/~`'.split('');
                const columns = Math.floor(canvas.width / MATRIX_FONT_SIZE);
                const drops = Array(columns).fill(1);
                
                let animationId;
                let lastFrame = 0;
                
                const draw = (timestamp) => {
                    if (!isRunning) return;
                    
                    // Throttle to MATRIX_FPS
                    if (timestamp - lastFrame < 1000 / MATRIX_FPS) {
                        animationId = requestAnimationFrame(draw);
                        return;
                    }
                    lastFrame = timestamp;
                    
                    ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    ctx.fillStyle = '#0F0';
                    ctx.font = `${MATRIX_FONT_SIZE}px monospace`;
                    
                    for (let i = 0; i < drops.length; i++) {
                        const text = chars[Math.floor(Math.random() * chars.length)];
                        const x = i * MATRIX_FONT_SIZE;
                        const y = drops[i] * MATRIX_FONT_SIZE;
                        
                        ctx.fillText(text, x, y);
                        
                        if (y > canvas.height && Math.random() > 0.975) {
                            drops[i] = 0;
                        }
                        drops[i]++;
                    }
                    
                    animationId = requestAnimationFrame(draw);
                };
                
                animationId = requestAnimationFrame(draw);
                
                return () => {
                    if (animationId) cancelAnimationFrame(animationId);
                };
            }, [isRunning]);
            
            return (
                <div className="my-4 relative">
                    <div className="flex justify-between items-center mb-2">
                        <span className="text-xs text-green-500 font-bold">MATRIX VISUAL INTERFACE v1.0</span>
                        <button
                            onClick={() => setIsRunning(!isRunning)}
                            className="text-xs px-2 py-1 border border-green-700 hover:bg-green-900/20 transition-colors rounded"
                            aria-label={isRunning ? "Pause matrix" : "Resume matrix"}
                        >
                            {isRunning ? '[PAUSE]' : '[RESUME]'}
                        </button>
                    </div>
                    <canvas
                        ref={canvasRef}
                        className="w-full border border-green-900/50 bg-black rounded"
                        style={{ height: '400px' }}
                        aria-label="Matrix rain animation"
                    />
                    <div className="mt-2 text-[10px] text-green-700">
                        The Matrix has you... Type 'clear' to exit.
                    </div>
                </div>
            );
        };

        const ServicesBlock = () => (
            <div className="ml-2 p-4 bg-white/5 border border-white/10 rounded text-sm space-y-3 backdrop-blur-sm">
                <div className="text-cyan-500/60 text-xs uppercase tracking-wider mb-4">Service Offerings</div>
                <div className="space-y-4">
                    <div>
                        <div className="text-white font-bold mb-1">‚ö° Systems Architecture</div>
                        <div className="text-cyan-300/80 text-xs">Digital infrastructure design, microservices, API-first systems, scalable backend architecture</div>
                    </div>
                    <div>
                        <div className="text-white font-bold mb-1">üöÄ Execution Engine</div>
                        <div className="text-cyan-300/80 text-xs">High-value contract delivery, venture technical execution, MVP ‚Üí Production pipeline</div>
                    </div>
                    <div>
                        <div className="text-white font-bold mb-1">üîß Digital Assets</div>
                        <div className="text-cyan-300/80 text-xs">Web3 infrastructure, smart contracts, decentralized systems, blockchain integration</div>
                    </div>
                    <div>
                        <div className="text-white font-bold mb-1">üåê Joint Ventures</div>
                        <div className="text-cyan-300/80 text-xs">Technical partnership, co-development, revenue share models, strategic collaboration</div>
                    </div>
                </div>
                <div className="mt-4 pt-3 border-t border-white/10 text-[10px] text-cyan-700">
                    Asset Light ‚Ä¢ Profit First ‚Ä¢ Global Mobility
                </div>
            </div>
        );

        const StackBlock = () => (
            <div className="ml-2 p-4 bg-white/5 border border-white/10 rounded text-sm space-y-3 backdrop-blur-sm">
                <div className="text-cyan-500/60 text-xs uppercase tracking-wider mb-4">Tech Arsenal</div>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <div className="text-white font-bold mb-2 text-xs">FRONTEND</div>
                        <div className="text-cyan-300/80 text-xs space-y-1">
                            <div>‚Üí React ‚Ä¢ Next.js ‚Ä¢ TypeScript</div>
                            <div>‚Üí Tailwind ‚Ä¢ Framer Motion</div>
                            <div>‚Üí WebAssembly ‚Ä¢ Canvas API</div>
                        </div>
                    </div>
                    <div>
                        <div className="text-white font-bold mb-2 text-xs">BACKEND</div>
                        <div className="text-cyan-300/80 text-xs space-y-1">
                            <div>‚Üí Node.js ‚Ä¢ Python ‚Ä¢ Rust</div>
                            <div>‚Üí PostgreSQL ‚Ä¢ Redis ‚Ä¢ MongoDB</div>
                            <div>‚Üí GraphQL ‚Ä¢ REST ‚Ä¢ WebSockets</div>
                        </div>
                    </div>
                    <div>
                        <div className="text-white font-bold mb-2 text-xs">INFRASTRUCTURE</div>
                        <div className="text-cyan-300/80 text-xs space-y-1">
                            <div>‚Üí Docker ‚Ä¢ Kubernetes ‚Ä¢ CI/CD</div>
                            <div>‚Üí AWS ‚Ä¢ Cloudflare ‚Ä¢ Vercel</div>
                            <div>‚Üí GitHub Actions ‚Ä¢ n8n</div>
                        </div>
                    </div>
                    <div>
                        <div className="text-white font-bold mb-2 text-xs">SPECIALTY</div>
                        <div className="text-cyan-300/80 text-xs space-y-1">
                            <div>‚Üí Web3 ‚Ä¢ Solidity ‚Ä¢ Ethers.js</div>
                            <div>‚Üí MIDI 2.0 ‚Ä¢ Audio DSP</div>
                            <div>‚Üí Accessibility (WCAG 2.2)</div>
                        </div>
                    </div>
                </div>
                <div className="mt-4 pt-3 border-t border-white/10 text-[10px] text-cyan-700">
                    Production-ready ‚Ä¢ Battle-tested ‚Ä¢ Spite-powered
                </div>
            </div>
        );

        const ManifestoBlock = () => (
            <div className="ml-2 text-xs md:text-sm opacity-90 font-sans leading-relaxed border border-dashed border-white/20 p-4 bg-white/5">
                <p className="mb-2 font-bold text-white">// CORE DIRECTIVE v2.4.0</p>
                <p className="mb-2">
                    GlitchWorks is a Systems Architecture Holding Company. We function as the Execution Engine for digital assets, ventures, and high-value service contracts.
                </p>
                <ul className="list-disc list-inside space-y-1 text-current">
                    <li>Asset Light Doctrine.</li>
                    <li>Profit First (War Chest Priority).</li>
                    <li>The Fleet is the Endgame (Global Mobility).</li>
                </ul>
                <div className="mt-4 pt-2 border-t border-white/10 flex items-center gap-2 text-[10px] uppercase tracking-widest">
                    <AlertTriangle />
                    <span>Authorized Personnel Only</span>
                </div>
            </div>
        );

        // Render with Error Boundary
        ReactDOM.render(
            <ErrorBoundary>
                <App />
            </ErrorBoundary>, 
            document.getElementById('root')
        );
    </script>
</body>
</html>